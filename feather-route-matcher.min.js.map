{"version":3,"file":"feather-route-matcher.min.js","sources":["index.js"],"sourcesContent":["// regexes borrowed from backbone\nvar optionalParam = /\\((.*?)\\)/g\nvar namedParam = /(\\(\\?)?:\\w+/g\n// eslint-disable-next-line no-useless-escape\nvar escapeRegExp = /[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g\nvar splatParam = /\\*/g\n\n// Parses a URL pattern such as `/users/:id`\n// and builds and returns a regex that can be used to\n// match said pattern. Credit for these\n// regexes belongs to Jeremy Ashkenas and the\n// other maintainers of Backbone.js\n//\n// It has been modified for extraction of\n// named paramaters from the URL\nfunction parsePattern (pattern) {\n  var names = []\n  pattern = pattern\n    .replace(escapeRegExp, '\\\\$&')\n    .replace(optionalParam, '(?:$1)?')\n    .replace(namedParam, function (match, optional) {\n      names.push(match.slice(1))\n      return optional ? match : '([^/?]+)'\n    })\n    .replace(splatParam, function (match, optional) {\n      names.push('path')\n      return '([^?]*?)'\n    })\n\n  return {\n    regExp: new RegExp('^' + pattern + '(?:\\\\?([\\\\s\\\\S]*))?$'),\n    namedParams: names\n  }\n}\n\nexport default function (routes, fallback) {\n  var keys = Object.keys(routes)\n\n  // loop through each route we're\n  // and build the shell of our\n  // route cache.\n  for (var item in routes) {\n    if (routes.hasOwnProperty(item)) {\n      routes[item] = {\n        value: routes[item]\n      }\n    }\n  }\n\n  // main result is a function that can be called\n  // with the url\n  return function (url) {\n    var params\n    var route\n\n    // start looking for matches\n    var matchFound = keys.some(function (key) {\n      var parsed\n\n      // fetch the route pattern from the cache\n      // there will always be one\n      route = routes[key]\n\n      // if the route doesn't already have\n      // a regex we never generated one\n      // so we do that here lazily.\n      // Parse the pattern to generate the\n      // regex once, and store the result\n      // for next time.\n      if (!route.regExp) {\n        parsed = parsePattern(key)\n        route.regExp = parsed.regExp\n        route.namedParams = parsed.namedParams\n        route.pattern = key\n      }\n\n      // run our cached regex\n      var result = route.regExp.exec(url)\n\n      // if null there was no match\n      // returning falsy here continues\n      // the `Array.prototype.some` loop\n      if (!result) {\n        return\n      }\n\n      // remove other cruft from result\n      result = result.slice(1, -1)\n\n      // reduce our match to an object of named paramaters\n      // we've extracted from the url\n      params = result.reduce(function (obj, val, index) {\n        if (val) {\n          obj[route.namedParams[index]] = val\n        }\n        return obj\n      }, {})\n\n      // stops the loop\n      return true\n    })\n\n    // no routes matched\n    if (!matchFound) {\n      if (fallback) {\n        return {\n          page: fallback,\n          url: url,\n          params: null\n        }\n      }\n      return null\n    }\n\n    return {\n      page: route.value,\n      params: params,\n      url: url,\n      pattern: route.pattern\n    }\n  }\n}\n"],"names":["optionalParam","namedParam","escapeRegExp","splatParam","routes","fallback","keys","Object","item","hasOwnProperty","value","url","params","route","some","key","parsed","regExp","pattern","names","replace","match","optional","push","slice","RegExp","namedParams","parsePattern","result","exec","reduce","obj","val","index","page"],"mappings":"mMACA,IAAIA,EAAgB,aAChBC,EAAa,eAEbC,EAAe,2BACfC,EAAa,aA8BF,SAAUC,EAAQC,GAC/B,IAAIC,EAAOC,OAAOD,KAAKF,GAKvB,IAAK,IAAII,KAAQJ,EACXA,EAAOK,eAAeD,KACxBJ,EAAOI,GAAQ,CACbE,MAAON,EAAOI,KAOpB,OAAO,SAAUG,GACf,IAAIC,EACAC,EAkDJ,OA/CiBP,EAAKQ,KAAK,SAAUC,GACnC,IAAIC,GAIJH,EAAQT,EAAOW,IAQJE,SACTD,EAvDR,SAAuBE,GACrB,IAAIC,EAAQ,GAaZ,OAZAD,EAAUA,EACPE,QAAQlB,EAAc,QACtBkB,QAAQpB,EAAe,WACvBoB,QAAQnB,EAAY,SAAUoB,EAAOC,GAEpC,OADAH,EAAMI,KAAKF,EAAMG,MAAM,IAChBF,EAAWD,EAAQ,aAE3BD,QAAQjB,EAAY,WAEnB,OADAgB,EAAMI,KAAK,QACJ,aAGJ,CACLN,OAAQ,IAAIQ,OAAO,IAAMP,EAAU,wBACnCQ,YAAaP,GAuCAQ,CAAaZ,GACtBF,EAAMI,OAASD,EAAOC,OACtBJ,EAAMa,YAAcV,EAAOU,YAC3Bb,EAAMK,QAAUH,GAIlB,IAAIa,EAASf,EAAMI,OAAOY,KAAKlB,GAK/B,GAAKiB,EAiBL,OAZAA,EAASA,EAAOJ,MAAM,GAAI,GAI1BZ,EAASgB,EAAOE,OAAO,SAAUC,EAAKC,EAAKC,GAIzC,OAHID,IACFD,EAAIlB,EAAMa,YAAYO,IAAUD,GAE3BD,GACN,KAGI,IAeF,CACLG,KAAMrB,EAAMH,MACZE,OAAQA,EACRD,IAAKA,EACLO,QAASL,EAAMK,SAdXb,EACK,CACL6B,KAAM7B,EACNM,IAAKA,EACLC,OAAQ,MAGL"}